import{a5 as o,a6 as r,a7 as l,a8 as d,a9 as n,aa as u,ab as m,ac as p,ad as f,ae as g,af as y,ag as b,ah as w,ai as v,aj as D,ak as _}from"./B1xS6FGY.js";const z=(a,t="BRL",s=null)=>(s=s===null?navigator.language:s,new Intl.NumberFormat(s,{style:"currency",currency:t}).format(a).replace(/\,/g,"-").replace(/\./g,",").replace(/\-/g,".")),S=a=>{if(!a)return"";var t=a.toLowerCase().trim();return t=t.normalize("NFD").replace(/[\u0300-\u036f]/g,""),t=t.replace(/[^a-z0-9\s-]/g," ").trim(),t=t.replace(/[\s-]+/g,"-"),t},F={currency:z,slug:S};class j{constructor(){this.save=new J(this),this.search=new R(this),this.delete=new k(this),this.storage=new P(this),this.events=[]}collection(){return"app"}defaults(){return{}}getDefaults(){return{id:null,...this.defaults(),created_at:null,updated_at:null}}toJson(){let t={};return Object.entries(this.getDefaults()).map(([s,e])=>{t[s]=e??null}),t}searchParams(){return{}}getSearchParams(){return{limit:20,order:"desc",order_by:"updated_at",...this.searchParams()}}on(t,s){this.events.push({name:t,call:s})}dispatch(t,...s){this.events.map(({name:e,call:i})=>{e==t&&i(...s)})}}class J{constructor(t){this.busy=!1,this.data=t.toJson(),this.on=(...s)=>t.on(...s),this.dispatch=(...s)=>t.dispatch(...s),this.toJson=()=>t.toJson(),this.collection=()=>t.collection()}set(t={}){return this.data={...this.toJson(),...t},this}fill(t={}){for(let s in t)this[s]=t[s];return this}async submit(){let t=this.data;const s=o();if(this.busy=!0,t.id){t.updated_at=r().format();const e=l(s,this.collection(),t.id);d(e,t,{merge:!0}),this.dispatch("updated",t),this.dispatch("saved",t)}else{t.created_at=t.updated_at=r().format();const e=n(s,this.collection()),i=await u(e,t);t.id=i.id,this.dispatch("created",t),this.dispatch("saved",t)}this.busy=!1}}class R{constructor(t){this.busy=!1,this.collection=t.collection(),this.params=t.getSearchParams(),this.data=[],this.on=(...s)=>t.on(...s),this.dispatch=(...s)=>t.dispatch(...s)}async submit(){this.busy=!0;const t=o();let e=[n(t,this.collection),m(this.params.order_by,this.params.order),p(this.params.limit)];const i=f(...e),h=await g(i);this.data=h.docs.map(c=>({...c.data(),id:c.id})),this.busy=!1}}class k{constructor(t){this.busy=!1,this.collection=()=>t.collection(),this.data=t.toJson(),this.on=(...s)=>t.on(...s),this.dispatch=(...s)=>t.dispatch(...s)}async submit(t){this.busy=!0,this.data=t;const s=o(),e=l(s,this.collection(),t.id);await y(e),this.dispatch("deleted",t),this.busy=!1}}class P{constructor(t){this.busy=!1,this.collection=()=>t.collection(),this.on=(...s)=>t.on(...s),this.dispatch=(...s)=>t.dispatch(...s)}async storeUploadData(t){const s=await b(t);return{url:await w(t),name:s.name,mime:s.contentType,size:s.size}}browse(){Object.assign(document.createElement("input"),{type:"file",onchange:t=>{t.target.files[0]&&this.upload(t.target.files[0])}}).click()}async upload(t){this.busy=!0;const s=v(),e=await D(_(s,t.name),t),i=await this.storeUploadData(e.ref);return this.busy=!1,i}remove(t){}}class x extends j{collection(){return"shop_product"}defaults(){return{id:null,sku:"",name:"",thumbnail:{url:"https://media.istockphoto.com/id/1222357475/vector/image-preview-icon-picture-placeholder-for-website-or-ui-ux-design-vector-illustration.jpg?s=612x612&w=0&k=20&c=KuCo-dRBYV7nz2gbk4J9w1WtTAgpTdznHu55W9FjimE=",name:"Empty Image",mime:"image/jpeg",size:1e3},dimona_slug:"",amount:null,active:null,colors:[],sizes:[],prints:[]}}}export{x as S,F as f};
